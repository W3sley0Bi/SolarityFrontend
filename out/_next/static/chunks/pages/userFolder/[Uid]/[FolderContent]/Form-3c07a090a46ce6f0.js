(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[108],{8885:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/userFolder/[Uid]/[FolderContent]/Form",function(){return n(7832)}])},7832:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var a=n(5893),r=n(6249),i=n(8723),o=n(3165),l=n(4017),s=n(7690),u=n(2741),c=n(8564),h=n(7294),d=n(1649),g=n(1163),f=n(6154),p=n(6770),y=n.n(p);function m(){let e=(0,g.useRouter)(),{theme:t}=(0,r.Z)(),{Uid:n,FolderContent:p}=e.query,[m,v]=(0,h.useState)(),[b,w]=(0,h.useState)(),[j,S]=(0,h.useState)(!1),[x,F]=(0,h.useState)(null),[E,k]=(0,h.useState)({}),_=(0,d.v9)(e=>e.token.value);(0,d.v9)(e=>e.uid.value),(0,d.v9)(e=>e.role.value);let A=x?[...x]:[],N=e=>{v(e)},R=async e=>null==m.sign1||null==m.sign2?(alert("missing signature"),!1):A.length>=3||(alert("you need to fill the Installateur section with min. 3 images!"),!1),I=e=>new Promise(t=>{y().imageFileResizer(e,300,300,"JPEG",100,0,e=>{t(e)},"base64")});(0,h.useEffect)(()=>{A.length>0&&A.forEach(async(e,t)=>{if(e instanceof File){let n=await I(e);k(e=>({...e,["file_".concat(t)]:n}))}})},[x]);let O=async()=>{let t=await R(A.length);if(!1===t)return;console.log(typeof A);let a=new FormData;console.log(E);let r=JSON.stringify(E),i=JSON.stringify(m);a.append("images",r),a.append("pdfData",i),a.append("Uid",n),a.append("FolderContent",p),a.append("textArea",b),S(!0),f.Z.post("".concat("https://sparkling-sweatpants-colt.cyclic.app","/formSign"),a,{headers:{Authorization:_}}).then(t=>{console.log(t),200==t.status?(alert("form sent correctly"),e.push("/")):(alert(t.status),console.log(t))}).catch(e=>console.log(e))};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(u.Z,{children:[(0,a.jsx)(c.Z,{getFromData:N}),(0,a.jsx)(i.Z,{y:5}),(0,a.jsxs)(o.Z,{style:{color:t.colors.primary.value,margin:"auto"},gap:3,children:[(0,a.jsxs)("details",{open:!0,style:{color:"white",borderRadius:"10px",padding:"15px"},children:[" ",(0,a.jsx)("summary",{children:"INSTALLATEUR SECTION"}),(0,a.jsx)(i.Z,{y:1}),(0,a.jsx)("input",{type:"file",onChange:e=>F(e.target.files),multiple:!0}),(0,a.jsx)("ul",{children:A.map((e,t)=>(0,a.jsxs)("li",{children:[e.name," - ",e.type]},t))}),(0,a.jsx)(i.Z,{y:.5}),(0,a.jsx)(l.Z,{width:"90%",label:"Notes",placeholder:"Add Notes",value:b,onChange:e=>w(e.target.value)})]}),(0,a.jsx)(i.Z,{y:5}),(0,a.jsx)(s.ZP,{onPress:O,disabled:j,children:"Send"}),(0,a.jsx)(i.Z,{y:5})]})]})})}},6770:function(e){(()=>{"use strict";var t={d:(e,n)=>{for(var a in n)t.o(n,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};t.r(n),t.d(n,{default:()=>r});var a=function(){var e;function t(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t)}return e=[{key:"changeHeightWidth",value:function(e,t,n,a,r,i){return n>a&&(e=Math.round(e*a/n),n=a),e>t&&(n=Math.round(n*t/e),e=t),r&&n<r&&(e=Math.round(e*r/n),n=r),i&&e<i&&(n=Math.round(n*i/e),e=i),{height:e,width:n}}},{key:"resizeAndRotateImage",value:function(e,t,n,a,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"jpeg",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,s=document.createElement("canvas"),u=e.width,c=e.height,h=this.changeHeightWidth(c,n,u,t,a,r);l&&(90===l||270===l)?(s.width=h.height,s.height=h.width):(s.width=h.width,s.height=h.height),u=h.width,c=h.height;var d=s.getContext("2d");return d.fillStyle="rgba(0, 0, 0, 0)",d.fillRect(0,0,u,c),d.imageSmoothingEnabled&&d.imageSmoothingQuality&&(d.imageSmoothingQuality="high"),l&&(d.rotate(l*Math.PI/180),90===l?d.translate(0,-s.width):180===l?d.translate(-s.width,-s.height):270===l?d.translate(-s.height,0):0!==l&&360!==l||d.translate(0,0)),d.drawImage(e,0,0,u,c),s.toDataURL("image/".concat(i),o/100)}},{key:"b64toByteArrays",value:function(e,t){t=t||"image/jpeg";for(var n=atob(e.toString().replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,"")),a=[],r=0;r<n.length;r+=512){for(var i=n.slice(r,r+512),o=Array(i.length),l=0;l<i.length;l++)o[l]=i.charCodeAt(l);var s=new Uint8Array(o);a.push(s)}return a}},{key:"b64toBlob",value:function(e,t){var n=this.b64toByteArrays(e,t);return new Blob(n,{type:t,lastModified:new Date})}},{key:"b64toFile",value:function(e,t,n){var a=this.b64toByteArrays(e,n);return new File(a,t,{type:n,lastModified:new Date})}},{key:"createResizedImage",value:function(e,n,a,r,i,o,l){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"base64",u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,h=new FileReader;if(!e)throw Error("File Not Found!");if(e.type&&!e.type.includes("image"))throw Error("File Is NOT Image!");h.readAsDataURL(e),h.onload=function(){var d=new Image;d.src=h.result,d.onload=function(){var h=t.resizeAndRotateImage(d,n,a,u,c,r,i,o),g="image/".concat(r);switch(s){case"blob":l(t.b64toBlob(h,g));break;case"base64":default:l(h);break;case"file":var f=e.name.toString().replace(/(png|jpeg|jpg|webp)$/i,"").concat(r.toString());l(t.b64toFile(h,f,g))}}},h.onerror=function(e){throw Error(e)}}}],function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(t,e),t}();let r={imageFileResizer:function(e,t,n,r,i,o,l,s,u,c){return a.createResizedImage(e,t,n,r,i,o,l,s,u,c)}};e.exports=n})()}},function(e){e.O(0,[676,570,562,764,154,97,564,774,888,179],function(){return e(e.s=8885)}),_N_E=e.O()}]);